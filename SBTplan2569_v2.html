<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SBT Plan 2569</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom font import and application */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9fafb;
        }
        /* Ensure icons are initialized */
        [lucide] {
            stroke-width: 2.5;
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div id="app" class="min-h-screen">
        <header class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 leading-tight">
                SBT Plan 2569
            </h1>
            <p id="counter" class="mt-2 text-lg text-indigo-600">
                Viewing Activity <span class="font-bold">1</span> of 17
            </p>
        </header>

        <!-- Navigation Controls (TOP) -->
        <div class="max-w-xl mx-auto mb-6 flex justify-between space-x-4">
            <button
                id="prev-button-top"
                class="flex-1 flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-full shadow-lg transition-all transform bg-indigo-600 text-white hover:bg-indigo-700 hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:bg-gray-200 disabled:text-gray-500 disabled:cursor-not-allowed"
                onclick="prevActivity()"
            >
                <i lucide="chevron-left" class="w-4 h-4 mr-1"></i> Previous Activity
            </button>
            <button
                id="next-button-top"
                class="flex-1 flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-full shadow-lg transition-all transform bg-indigo-600 text-white hover:bg-indigo-700 hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:bg-gray-200 disabled:text-gray-500 disabled:cursor-not-allowed"
                onclick="nextActivity()"
            >
                Next Activity <i lucide="chevron-right" class="w-4 h-4 ml-1"></i>
            </button>
        </div>
        <!-- End Navigation Controls (TOP) -->

        <!-- Main Activity Card -->
        <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-2xl p-6 sm:p-10 border border-indigo-100">
            <div class="mb-8 border-b pb-4">
                <h2 id="activity-title" class="text-2xl sm:text-3xl font-bold text-indigo-700"></h2>
            </div>

            <!-- Core Details Section -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <!-- Owner -->
                <div class="flex items-start space-x-3 p-4 bg-white/50 backdrop-blur-sm rounded-xl shadow-md border border-gray-100">
                    <i lucide="user" class="w-6 h-6 text-indigo-600 flex-shrink-0 mt-0.5"></i>
                    <div class="flex-1">
                        <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wider">Owner</h3>
                        <p id="detail-owner" class="text-base text-gray-900 mt-1 whitespace-pre-wrap">—</p>
                    </div>
                </div>
                <!-- Team -->
                <div class="flex items-start space-x-3 p-4 bg-white/50 backdrop-blur-sm rounded-xl shadow-md border border-gray-100">
                    <i lucide="users" class="w-6 h-6 text-indigo-600 flex-shrink-0 mt-0.5"></i>
                    <div class="flex-1">
                        <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wider">Team / ผู้ร่วมงาน</h3>
                        <p id="detail-team" class="text-base text-gray-900 mt-1 whitespace-pre-wrap">—</p>
                    </div>
                </div>
                <!-- KPI -->
                <div class="flex items-start space-x-3 p-4 bg-white/50 backdrop-blur-sm rounded-xl shadow-md border border-gray-100">
                    <i lucide="target" class="w-6 h-6 text-indigo-600 flex-shrink-0 mt-0.5"></i>
                    <div class="flex-1">
                        <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wider">Related KPI / KPI ที่เกี่ยวข้อง</h3>
                        <p id="detail-kpi" class="text-base text-gray-900 mt-1 whitespace-pre-wrap">—</p>
                    </div>
                </div>
                <!-- Budget -->
                <div class="flex items-start space-x-3 p-4 bg-white/50 backdrop-blur-sm rounded-xl shadow-md border border-gray-100">
                    <i lucide="dollar-sign" class="w-6 h-6 text-indigo-600 flex-shrink-0 mt-0.5"></i>
                    <div class="flex-1">
                        <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wider">Requirements / Budget</h3>
                        <p id="detail-budget" class="text-base text-gray-900 mt-1 whitespace-pre-wrap">—</p>
                    </div>
                </div>
            </div>

            <!-- Quarterly Plan Section -->
            <h3 class="flex items-center text-xl font-bold text-gray-800 mb-4 border-b pb-2 mt-8">
                <i lucide="clock" class="w-5 h-5 mr-2"></i> Quarterly Plan (2025-2026)
            </h3>
            <div class="space-y-4 mb-10" id="quarterly-plans">
                <!-- Plan items will be injected here -->
            </div>
            
            <!-- Note / Context Section -->
            <div class="p-6 bg-yellow-50 rounded-xl border border-yellow-200">
                <h3 class="flex items-center text-lg font-bold text-yellow-800 mb-2">
                    <i lucide="book-open" class="w-5 h-5 mr-2"></i> Note / Context
                </h3>
                <p id="detail-note" class="text-gray-700 whitespace-pre-wrap">ไม่มีหมายเหตุเพิ่มเติม</p>
            </div>
        </div>

        <!-- Navigation Controls (BOTTOM) -->
        <div class="max-w-xl mx-auto mt-10 flex justify-between space-x-4">
            <button
                id="prev-button"
                class="flex-1 flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-full shadow-lg transition-all transform bg-indigo-600 text-white hover:bg-indigo-700 hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:bg-gray-200 disabled:text-gray-500 disabled:cursor-not-allowed"
                onclick="prevActivity()"
            >
                <i lucide="chevron-left" class="w-5 h-5 mr-2"></i> Previous Activity
            </button>
            <button
                id="next-button"
                class="flex-1 flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-full shadow-lg transition-all transform bg-indigo-600 text-white hover:bg-indigo-700 hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:bg-gray-200 disabled:text-gray-500 disabled:cursor-not-allowed"
                onclick="nextActivity()"
            >
                Next Activity <i lucide="chevron-right" class="w-5 h-5 ml-2"></i>
            </button>
        </div>
    </div>

<script>
    // --- Full Data (17 Activities) extracted from 'SBT Plan 2569' Spreadsheet ---
    const PLAN_DATA = [
        // ... (Keep the existing PLAN_DATA array as is) ...
        {
 "activity": " การคัดเลือกโครงการเพื่อประเมินผลกระทบ ",
 "relatedKPI": " คัดเลือก 2 โครงการ เพื่อประเมินมูลค่าผลกระทบ ",
 "note": " ปี69 แค่คัดเลือกโครงการ และจะเริ่มประเมินมูลค่าฯ ปี 70 1 โครงการด้านชุมชน (เช่น โครงการอ.ไผ่, อ.สุดารัตน์) 1 โครงการด้านอุตสาหกรรม (เช่น อ.ปีย์, อ.ณัฐฏา, อ.อ้อม คอมบูชะ) ต้องดูเรื่องข้อตกลงภาระงานปี 70 ให้ด้วย ",
 "owner": " อ.ภาวิณี ",
 "team": " หัวหน้าโครงการและผู้ร่วมวิจัยในโครงการที่ถูกคัดเลือก ",
 "planOctDec": " แป้งช่วยดึงข้อมูลโครงการปี 67, 68, 69 ออกมาเพื่อให้คณะทำงานคัดเลือก (นำไปคัดเลือกในที่ประชุมกก.พัฒนา) ",
 "planJanMar": " ประชาสัมพันธ์ให้บุคลากรเข้าอบรม (สวนพ.เป็นผู้จัดงานอบรม) ",
 "planAprJun": " ประชาสัมพันธ์ให้บุคลากรเข้าอบรม (สวนพ.เป็นผู้จัดงานอบรม) ",
 "planJulSep": " ประชาสัมพันธ์ให้บุคลากรเข้าอบรม (สวนพ.เป็นผู้จัดงานอบรม) ",
 "budget": " ไม่มีความต้องการใช้งบประมาณ ",
 },

{
 "activity": " One-stop service + วิธีการเก็บข้อมูลผู้มาใช้บริการ ",
 "relatedKPI": " รายรับวิจัย/บริการวิชาการ/IP ≥ 0.656 ล้านบาท/FTE, จำนวน Non-degree courses 5 รายวิชา, มีระบบรับและส่งมอบงานบริการวิชาการที่มีประสิทธิภาพ ",
 "note": " เจ้าหน้าที่ที่เกี่ยวข้องดำเนินกิจกรรมในข้อที่ 11 และ 17 ควบคู่ไปด้วย ",
 "owner": " อ.กรณ์กนก ",
 "team": " อ.ภาวิณี อ.กนกวรรณ, คุณกมลวรรณ, คุณณัฐรินทร์ ",
 "planOctDec": " สำรวจจำนวนโครงการ/กิจกรรมงานบริการวิชาการ/รับจ้างวิจัย และ จำนวนเงินรายได้ที่มีในช่วง 2 ปี ที่ผ่านมา แบ่งตามรายไตรมาส รวมทั้งมีข้อมูลของลูกค้าที่มาใช้บริการ ",
 "planJanMar": " - สำรวจจำนวน non-degree ที่คณะมีอยู่เดิม - ประชุมสรุปผลความสำเร็จและศักยภาพของ non-degree ที่มีอยู่ในปัจจุบัน (active/non-active) ",
 "planAprJun": " สำรวจความต้องการของลูกค้า ด้านความต้องการขอรับบริการ งานบริการวิชาการ/วิจัย และ non-degree จากผู้มีส่วนได้ส่วนเสียเป้าหมาย ",
 "planJulSep": " หาข้อสรุป เพื่อนำเสนองานบริการวิชาการ/รับจ้างวิจัย และ non-degree ใหม่ ๆ อย่างน้อยอย่างละ 1 รายการ ",
 "budget": " ค่าดำเนินการสำรวจความต้องการ ",
 },

{
 "activity": " โครงการปรับปรุงห้องเรียนและห้องปฏิบัติการ ",
 "relatedKPI": " รายรับวิจัย/บริการวิชาการ/IP ≥ 0.656 ล้านบาท/FTE, จำนวน Non-degree courses 5 รายวิชา, ห้องปฏิบัติการที่ผ่านการประเมินตามมาตรฐาน 1 ห้อง ",
 "note": " เตรียมของบรัฐปี 71 (ส่งเอกสารทุกอย่างภายในกันยายน 69) เพื่อ 1. ปรับปรุงห้องเรียนเพื่อเพิ่มรายได้จาก non-degree 2. ปรับปรุงห้องปฏิบัติการ เพื่อเพิ่มรายได้จากงานบริการวิชาการ 3. ปรับปรุงห้องปฏิบัติการเพื่อให้ได้มาตรฐานตาม BSL ",
 "owner": " อ.กรณ์กนก ",
 "team": " ตัวแทนอาจารย์และห้องปฏิบัติการ, คุณพงศ์ธร, คุณวราภรณ์ บุญถูก, คุณณัฐรินทร์ ",
 "planOctDec": " เลือกห้องที่จะปรับปรุง ติดต่อบริษัท เพื่อมาดูหน้างาน ออกแบบ เขียนราคากลาง ติดต่อฝ่ายอาคารบางมด และบางขุนเทียนดูแบบอาคาร ",
 "planJanMar": "  ",
 "planAprJun": " นำเข้าที่ประชุมฝ่ายอาคารบางขุนเทียน และบางมด ",
 "planJulSep": " ส่งเอกสารคำของบรัฐให ้สนย. ",
 "budget": "  ",
 },

{
 "activity": " โครงการปิดแอร์ช่วงกลางวัน ",
 "relatedKPI": " 0.7 I/E ratio, ค่าไฟฟ้าต่อรายรับหน่วยงาน = 15.86% ",
 "note": " ขอความร่วมมือ ห้องแลป ต่างๆ ในตึก ",
 "owner": " อ.กรณ์กนก ",
 "team": " ตัวแทนห้องปฏิบัติการต่าง คุณต้อม คุณมินต์ คุณสตีฟ ",
 "planOctDec": " เก็บข้อมูลค่าไฟฟ้ารายไตรมาส ในรอบ 2 ปีที่ผ่านมา ",
 "planJanMar": " กิจกรรมประชาสัมพันธ์ สื่อสารกับบุคลากร ด้วยวาจา และจัดทำสติกเกอร์ ",
 "planAprJun": " แสดงข้อมูลการใช้ไฟและค่าไฟของหน่วยงานให้ทุกคนรับรู้ ",
 "planJulSep": " เปรียนบเทียบข้อมูลการใช้ไฟฟ้าที่ลดลง ",
 "budget": " ค่าจัดทำสติกเกอร์ประชาสัมพันธ์ ",
 },

{
 "activity": " การจัดทำกระบวนการติดตามการใช้งบประมาณวิจัย และความก้าวหน้าของโครงการวิจัย ",
 "relatedKPI": " มีระบบบริหารงานวิจัย ",
 "note": " 1. การทำความเข้าใจระหว่าง ฝ่ายการเงิน กับหัวหน้าโครงการ 2. ติดตามการใช้เงินให้เป็นไปตามแผน ไม่อยากให้เบิกทีเดียวตอนจะปิดโครงการ ",
 "owner": " อ.กรณ์กนก ",
 "team": " คุณภักพินัน, คุณ วราภรณ์ บุญถูก คุณณัฐรินทร์ ",
 "planOctDec": " จัดทำ Flow การทำงาน ที่เกี่ยวข้องกับการเบิกจ่ายโดยฝ่ายปฏิบัติการให้มีความชัดเจน ",
 "planJanMar": " ประชุมสื่อสารและสร้างความเข้าใจให้กับหัวหน้าโครงการวิจัยและตัวแทนที่รับผิดชอบการเบิกจ่ายเงินของโครงการฯ ",
 "planAprJun": " ติดตามผลการดำเนินงานเรื่องการเบิกจ่ายว่าเป็นไปตามแผนที่คาดหวังหรือไม่ ",
 "planJulSep": " สรุปผล โดยคาดหวังให้การเบิกจ่ายเงินของโครงการเป็นไปตามแผนและมีผลลัพธ์ที่ดีกว่าปีที่ผ่านมา ",
 "budget": "  ",
 },

{
 "activity": " กิจกรรมแนะนำการเขียน UKPSF ",
 "relatedKPI": " จำนวนอาจารย์ที่ได้รับรองมาตรฐาน PSF 11 คน, จำนวนอาจารย์ที่ใช้นวัตกรรมการสอน 10 คน ",
 "note": " ปี 69 จำนวน 11 คน ปี 70 จำนวน 15 คน (KMUTT PSF หรือ ม.ช่วย 50% สำหรับ UKPSF) ",
 "owner": " อ.ธีรพันธ์ ",
 "team": " บุคลากรผู้ผ่าน PSF ปี  69 ",
 "planOctDec": " 1. แนะนำการปรับแก้ไขให้กับอาจารย์ 6 คน ที่ส่งไปแล้ว 2. แนะนำการเขียนให้กับ อาจารย์อีก 4 คน ",
 "planJanMar": " สำรวจรายชื่อบุคลากรที่จะขอ PSF อีก 15 คนของคณะ + สำรวจความพร้อม ",
 "planAprJun": " 1. แชร์ประสบการณ์โดยผู้ได้รับการรับรองปี 69 2. แต่งตั้งพี่เลี้ยง ",
 "planJulSep": " 1. กิจกรรมแนะนำการเขียน 2. พี่เลี้ยงให้คำปรึกษา ",
 "budget": "  ",
 },

{
 "activity": " กิจกรรมอบรม Digital Literacy และ Digital Technology ",
 "relatedKPI": " 100% จำนวนบุคลากรที่มี Digital literacty, จำนวนอาจารย์ที่ใช้นวัตกรรมการสอน 10 คน ",
 "note": " มีคอร์สของม. เกษตร ที่ฟรี และเป็นภาษาไทย ต้องทำการประเมินหลังกิจกรรม ",
 "owner": " อ.ธีรพันธ์ ",
 "team": "  ",
 "planOctDec": "  ",
 "planJanMar": " แนะนำคอร์สของม.เกษตร หรือ course AI literacy ของ KMUTT Coursera ",
 "planAprJun": " อบรมการใช้ Productivity tools) ",
 "planJulSep": " อบรมการใช้ teaching/research tools (NotebookLM, LEB2, Kahoot, etc.) ",
 "budget": " ค่าอาหารว่าง ",
 },

{
 "activity": " การจัดทำระบบวิเคราะห์ข้อมูล เพื่อจัดประเภทโครงการต่าง ๆ เช่น โครงการที่ร่วมกับภาคอุตสาหกรรม/ ภาครัฐ, ด้านชุมชน/สิ่งแวดล้อม, โครงการที่ถูกนำไปใช้ประโยชน์จริง ",
 "relatedKPI": " จำนวนโครงการวิจัยที่ร่วมกับอุตสาหกรรม/ภาครัฐ 7 โครงการ, จำนวนโครงการวิจัยที่ร่วมกับชุมชน/สิ่งแวดล้อม 1 โครงการ, จำนวนโครงการวิจัยหรือผลงานวิจัยที่ถูกนำไปใช้ 2 โครงการ, มีระบบบริหารงานวิจัย ",
 "note": " - ปรับฟอร์มในการกรอกภาระงาน และรายงานผลที่มีคุณค่า เช่นให้มีติ๊กเลือกประเภทของโครงการ - หรือมี google excel ให้กรอกข้อมูลทุกๆ เดือน - แป้งแจ้งว่า ยังขาดการเชื่อมโยง สถานะภาพโครงการกับรายการโครงการวิจัย - แป้งแจ้งว่า ข้อมูล export จาก KIRIM ยังมีปัญหาเรื่องความซ้ำซ้อน ",
 "owner": " อ.ธีรพันธ์ ",
 "team": " แป้ง สามารถใช้ AI เช่น NotebookLM เพื่อช่วย ค้นหาและสรุปว่าโครงการใด เข้าข่ายประเภทไหนบ้าง ",
 "planOctDec": " ทดลองใช้ AI เช่น NotebookLM ในการสรุปและแยกประเภทของโครงการ ",
 "planJanMar": "  ",
 "planAprJun": "  ",
 "planJulSep": "  ",
 "budget": "  ",
 },

{
 "activity": " งานพัฒนาและดำเนินงานรายวิชา Bioscience entrepreneurship ",
 "relatedKPI": " นศ. 30% มี Entrepreneurial mindset ",
 "note": "  ",
 "owner": " อ.กนกวรรณ ",
 "team": " อ.นิษก์นิภา ",
 "planOctDec": " ทาบทามและเสนอชื่อคณะทำงานเพื่อ ดำเนินการจัดการเรียนการสอน ",
 "planJanMar": " ประชุมคณะทำงาน เพื่อออกแบบกระบวนการการเรียน การสอน และการวัดประเมินผล ",
 "planAprJun": " ประชุมคณะทำงาน เพื่อออกแบบกระบวนการการเรียน การสอน และการวัดประเมินผล (ต่อ) ",
 "planJulSep": " นำรายละเอียดรายวิชาเข้าระบบ LEB2 สำหรับการลงทะเบียน ในภาคการศึกษา 1/2568 ",
 "budget": " ค่าอาหาร และของว่าง กรณีมีการประชุม on site ",
 },

{
 "activity": " กิจกรรมเรียนรู้ PDCA ",
 "relatedKPI": "  ",
 "note": " เป้าหมาย: บุคลากรสายวิชาการมีความเข้าใจพื้นฐานและเห็นความ สำคัญของการประกันคุณภาพ (เช่น PDCA ) และนำไปประยุกต์ใช้กับการเรียนการสอนและการดำเนินการวิจัยได้ (อย่างน้อย 50% ของบุคลากรผู้เข้าร่วมโครงการ) ",
 "owner": " อ.กนกวรรณ ",
 "team": " ติดต่อวิทยากรและ จัดตารางกิจกรรม ",
 "planOctDec": " กิจกรรมการเรียนรู้ ครั้งที่ 1 ",
 "planJanMar": " กิจกรรมการเรียนรู้ ครั้งที่ 2 ",
 "planAprJun": " กิจกรรมการเรียนรู้ ครั้งที่ 3 ",
 "planJulSep": " - ",
 "budget": " 1. ค่าตอบแทนวิทยากร (3 ท่าน) 2. ของที่ระลึกวิทยากร 3. ค่าอาหารว่างผู้เข้าร่วมงาน ",
 },

{
 "activity": " การทำ SOP ด้านการเงิน และพัสดุ ดำเนินการต่อด้าน DM ",
 "relatedKPI": " มี SOP ด้านการเงิน และพัสดุ ",
 "note": " นำ SOP ของงานการศึกษามาประกอบการศึึกษา ",
 "owner": " อ.กนกวรรณ ",
 "team": " อ.ปีย์ (ดูด้านการเงิน) อ.จ๋า (ดูด้านพัสดุ) ",
 "planOctDec": " ประชุมกับ QAO เพื่อจัดทำแผนกิจกรรม ",
 "planJanMar": " ดำเนินกิจกรรมตามแผน ",
 "planAprJun": " ดำเนินกิจกรรมตามแผน ",
 "planJulSep": " ดำเนินกิจกรรมตามแผน ",
 "budget": " ค่าอาหารว่างผู้เข้าร่วมกิจกรรม ",
 },

{
 "activity": " 1. กิจกรรมถอดบทเรียน เพื่อ วิเคราะห์ ปรับปรุง กระบวนการ การทำข้อตกลงภาระงาน 2. กำหนด TOR หัวหน้าสาขาวิชา ",
 "relatedKPI": " มีระบบประเมินผลงานที่สะท้อนประสิทธิภาพ ",
 "note": " เป้าหมาย: 1. เพื่อปรับปรุงรูปแบบของข้อตกลงภาระงานที่แยกออกจากงานประจำ 2. เพื่อจัดทำ TOR ของรองคณบดีและประธานสาขาที่ชัดเจน ที่สามารถทำให้เอื้อต่อการประเมิน ",
 "owner": " อ.วาริช ",
 "team": " สตีฟ (เลขา) แป้ง ",
 "planOctDec": " ทบทวนกระบวนการตกลงภาระงานเดิมและวิเคราะห์ผล ",
 "planJanMar": " การจัดทำ TOR รองคณบดีทั้ง 4 ฝ่าย ",
 "planAprJun": " การจัดทำ TOR ประธานสาขาวิชา ",
 "planJulSep": " ชี้แจงรูปแบบการจัดทำข้อตกลงภาระงานที่ปรับ ",
 "budget": " ค่าอาหารว่างการประชุมคณะทำงาน ค่าของที่ระลึกวิทยากร ",
 },

{
 "activity": " การจัดทำระบบบริหารจัดการงานการศึกษา โดยเริ่มจากการจัดทำ work process 10% ของงานทั้งหมด ภายในปี 69 เช่น ด้านงานวิทยานิพนธ์ ",
 "relatedKPI": " มีระบบบริหารจัดการงานการศึกษา ",
 "note": "  ",
 "owner": " อ.สุดารัตน์ ",
 "team": " พี่ฟะฮ อ.ธีรพันธ์ อ.สราวุธ อ.สราวุธเสนอการทำ AI chatbot ที่สามารถให้ข้อมูลด้านการศึกษาให้แก่ นศ.และบุคลากร ",
 "planOctDec": "  ",
 "planJanMar": "  ",
 "planAprJun": "  ",
 "planJulSep": "  ",
 "budget": "  ",
 },

{
 "activity": " 1. งานประชาสัมพันธ์หลักสูตร (โดยเฉพาะหลักสูตรใหม่) 2. การอับเดตข้อมูลหลักสูตรใหม่ ผ่าน Facebook, SBT website ",
 "relatedKPI": " 45% International students, มีผู้รับผิดชอบด้านการประชาสัมพันธ์เชิงรุก ",
 "note": "  ",
 "owner": " อ.เลขา ",
 "team": "  ",
 "planOctDec": " - อินโฟกราฟิกจุดเด่น - โพสต์ Facebook - อัปเดตข้อมูลหลักสูตรในเว็บ SBT ",
 "planJanMar": " - วิดีโอแนะนำหลักสูตรโท–เอก (3–5 นาที) - โพสต์ Facebook ",
 "planAprJun": "  ",
 "planJulSep": "  ",
 "budget": " ค่าจัดทำวิดีโอแนะนำหลักสูตร 35,000 – 45,000 บาท ",
 },

{
 "activity": " กิจกรรมส่งเสริมให้ นศ. เป็น Change agent with green heart mindset ",
 "relatedKPI": " 100% นศ. เป็น Change agent with green heart mindset ",
 "note": " ชวนหลักสูตร CE/NRM มาช่วยจัดกิจกรรม เช่นการดูนก ",
 "owner": " อ.เลขา ",
 "team": " อ.ดุสิต + Conservation Ecology Program ",
 "planOctDec": "  ",
 "planJanMar": "  ",
 "planAprJun": "  ",
 "planJulSep": "  ",
 "budget": "  ",
 },

{
 "activity": " กิจกรรมพัฒนาทักษะผู้ประกอบการ ให้นศ.และนักวิจัยรุ่นใหม่ ",
 "relatedKPI": " 85% ผู้เข้าร่วมมีทักษะผู้ประกอบการระดับ B ขึ้นไป ",
 "note": " - เชิญ ดร.อมรรัตน์ จาก สวนพ. มาบรรยาย -เชิญผู้ประกอบการแลกเปลี่ยนมุมมอง -ทีมผู้ร่วมกิจกรรมพัฒนาทักษะผ่านการทำโปรเจ็คร่วมกับผู้ประกอบการ บริษัท ภาคเอกชน/อุตสาหกรรม โดยมีผลลัพธ์ในการพัฒนาผลิตภัณฑ์ กระบวนการหรือการบริการวิชาการ - ต้องมีการประเมินทักษะก่อนและหลังจบกิจกรรม โดยอาจใช้ rubrics จากโครงการ T1 และ Industrial postdocs ",
 "owner": " อ.นิษก์นิภา ",
 "team": " ที่ปรึกษาภายในและภายนอกและตัวแทนสาขาวิชา อ กรณ์/อ ภัทรา/ อ.บอล/อ.จ๋า อ.กนกวรรณ/อ.หนุ่ย/อ.ตุ๋ม/อ.โบว์/อ.โอ๊ค/อ.แตงโม เลขาน้องแป้ง (แผนกิจกรรม) พี่นิด (ส่วนประเมินผล) ผช.เลขาน้องมี่ (ประสานงานโครงการ) ",
 "planOctDec": " คณะทำงานระดมสมอง ทำแผนงบประมาณ (พ.ย.) การคัดเลือกทีมนักศึกษา/นักวิจัยรุ่นใหม่ แนะนำโครงการ (ต้นธค) ) ",
 "planJanMar": " นำเสนอ concept แต่ละทีม ดำเนินกิจกรรม (มค) นำเสนอผลงาน ออกบูธ /SBT shop เพื่อนำเสนอผลิตภัณฑ์และบริการวิชาการจากงานวิจัยและนวัตกรรมของคณะ (กพ-มีนา) ประเมินทักษะหลังเข้าร่วมกิจกรรม (3 เดือน) ",
 "planAprJun": " ดำเนินกิจกรรม ประเมินทักษะหลังเข้าร่วมกิจกรรม (6 เดือน) ",
 "planJulSep": " สรุปผลการดำเนินงาน จัดทำข้อเสนอแนะ รายงานโครงการ ",
 "budget": " ประมาณการผู้ร่วมโครงการ 35 คน (ประมาณ 5-7 ทีม) ทีมคณะทำงาน 15 คน รวม 50 คน (งบดำเนินการ 50,000 บาท) ",
 },

{
 "activity": " การจัดทำระบบเก็บข้อมูลคนที่มาติดต่อคณะ ด้านการศึกษา วิจัย และบริการวิชาการ ",
 "relatedKPI": " ผู้มาติดต่อด้านการศึกษา/วิจัย/บริการวิชาการเพิ่มร้อยละ 5 ",
 "note": " - เช่น จะเก็บอย่างไร ถ้าคนมาติดต่อที่แลป หรือ อาจารย์ โดยไม่ผ่านคณะ - ต้องมีการกำหนด contact point เช่นด้านการศึกษา คือ พี่นิด ด้านวิจัย คือ มี่ ",
 "owner": " อ.สราวุธ ",
 "team": " อ.ชัยรัตน์ พี่นิด พี่แดง มี่ ",
 "planOctDec": " อ.สราวุธเสนอการทำ AI chatbot ที่สามารถให้ข้อมูลด้านการศึกษา และวิจัย ",
 "planJanMar": "  ",
 "planAprJun": "  ",
 "planJulSep": "  ",
 "budget": "  ",
 }
    ];

    let currentActivityIndex = 0;
    const totalItems = PLAN_DATA.length;

    // New function: Read index from URL query parameter
    function readActivityIndexFromURL() {
        const params = new URLSearchParams(window.location.search);
        // 'activity' index is 1-based in the URL for user readability (e.g., ?activity=1)
        const activityNumber = parseInt(params.get('activity')); 
        
        if (!isNaN(activityNumber) && activityNumber >= 1 && activityNumber <= totalItems) {
            // Convert 1-based number to 0-based array index
            currentActivityIndex = activityNumber - 1;
        } else {
            // Default to the first activity if the URL parameter is missing or invalid
            currentActivityIndex = 0;
            // Also update the URL to reflect the default
            updateURL();
        }
    }

    // New function: Update URL to reflect the current activity index
    function updateURL() {
        // Use history.pushState to change the URL without reloading the page
        // Use 1-based index for the URL
        const activityNumber = currentActivityIndex + 1;
        const newUrl = `${window.location.pathname}?activity=${activityNumber}`;
        window.history.pushState({ path: newUrl }, '', newUrl);
    }

    // Function to create HTML for a quarterly plan item
    function createPlanItemHTML(quarter, content) {
        const displayContent = content || 'ไม่มีกิจกรรมที่กำหนด';
        return `
            <div class="border-l-4 border-indigo-400 pl-4 py-2 hover:bg-indigo-50 transition-colors rounded-r-lg">
                <p class="text-xs font-bold uppercase text-indigo-600 mb-1">${quarter}</p>
                <p class="text-sm text-gray-700 whitespace-pre-wrap">${displayContent}</p>
            </div>
        `;
    }

    // Main rendering function
    function renderActivity() {
        if (totalItems === 0) {
            document.getElementById('app').innerHTML = '<div class="flex items-center justify-center h-full"><p class="text-xl text-gray-500">ไม่พบข้อมูลในสเปรดชีตสำหรับการแสดงผล</p></div>';
            return;
        }

        const activity = PLAN_DATA[currentActivityIndex];

        // Update Header Counter
        document.getElementById('counter').innerHTML = `
            Viewing Activity <span class="font-bold">${currentActivityIndex + 1}</span> of ${totalItems}
        `;

        // Update Core Details
        document.getElementById('activity-title').textContent = activity.activity;
        document.getElementById('detail-owner').textContent = activity.owner || '—';
        document.getElementById('detail-team').textContent = activity.team || '—';
        document.getElementById('detail-kpi').textContent = activity.relatedKPI || '—';
        document.getElementById('detail-budget').textContent = activity.budget || '—';
        document.getElementById('detail-note').textContent = activity.note || 'ไม่มีหมายเหตุเพิ่มเติม';

        // Update Quarterly Plans
        const plansContainer = document.getElementById('quarterly-plans');
        plansContainer.innerHTML = ''; // Clear previous content

        plansContainer.innerHTML += createPlanItemHTML("Oct-Dec 2025", activity.planOctDec);
        plansContainer.innerHTML += createPlanItemHTML("Jan-Mar 2026", activity.planJanMar);
        plansContainer.innerHTML += createPlanItemHTML("Apr-June 2026", activity.planAprJun);
        plansContainer.innerHTML += createPlanItemHTML("July-Sep 2026", activity.planJulSep);

        // Update Navigation Buttons state
        const isDisabledPrev = currentActivityIndex === 0;
        const isDisabledNext = currentActivityIndex === totalItems - 1;

        // Select all 'Previous' buttons (bottom and top) and update their state
        const prevBtns = document.querySelectorAll('#prev-button, #prev-button-top');
        // Select all 'Next' buttons (bottom and top) and update their state
        const nextBtns = document.querySelectorAll('#next-button, #next-button-top');

        prevBtns.forEach(btn => btn.disabled = isDisabledPrev);
        nextBtns.forEach(btn => btn.disabled = isDisabledNext);
    }

    // Navigation Functions - MODIFIED to call updateURL
    function nextActivity() {
        if (currentActivityIndex < totalItems - 1) {
            currentActivityIndex++;
            updateURL(); // Update the URL before rendering
            renderActivity();
        }
    }

    function prevActivity() {
        if (currentActivityIndex > 0) {
            currentActivityIndex--;
            updateURL(); // Update the URL before rendering
            renderActivity();
        }
    }

    // Handle browser's back/forward buttons
    window.onpopstate = () => {
        readActivityIndexFromURL();
        renderActivity();
    };

    // Attach global functions to window for onclick handlers
    window.nextActivity = nextActivity;
    window.prevActivity = prevActivity;

    // Add keyboard navigation (left/right arrow keys) for page navigation
    window.onkeydown = (e) => {
        if (e.key === 'ArrowLeft') {
            prevActivity();
        } else if (e.key === 'ArrowRight') {
            nextActivity();
        }
    };

    // Initialize the view when the window loads - MODIFIED to read from URL first
    window.onload = () => {
        readActivityIndexFromURL(); // Read initial state from URL
        renderActivity();
        // Re-render lucide icons after content is loaded
        lucide.createIcons();
    };
</script>
</body>
</html>